# porcupine server configuration file

{
	'services' : [
            {
                'name'           : 'management',
                'type'           : 'TCPListener',
                'class'          :
                    'porcupine.core.services.management.ManagementServer',
                'address'        : 'localhost:6001',
                'worker_processes' : 0,
                'worker_threads' : 2,
            },
            {
                'name'           : 'main',
                'type'           : 'TCPListener',
                'class'          : 'porcupine.core.services.main.PorcupineServer',
                'address'        : 'localhost:21567',
                'worker_processes' : 0,
                'worker_threads' : 8,
            },
		],
	'global' : {
            'temp_folder'  : 'tmp'
		},
	'store' : {
            # tuples of (field_name, unique, immutable)
            'indices'             : (
                                        ('_parentid', False, False),
                                        ('displayName', True, False),
                                        ('modified', False, False),
                                        ('isCollection', False, True)
                                    ),
            'interface'           : 'porcupine.db.bsddb.DB',
            'bdb_data_dir'        : 'store',
            # log files location
            # for high perfomance services keep them in a separate disk
            # 'bdb_log_dir'         : 'store',

            # cache size (GB, bytes)
            # default value is set to 512K
            'cache_size'          : (0, 524288),

            # max number of simultaneous transactions
            # if you have hot resources (i.e. updated frequently)
            # lowering this value may increase throughput
            'max_tx'              : 20,

            # how many times a transaction is retried
            # before a deadlock error is raised
            'trans_max_retries'   : 16,

            # the timeout threshold for a lock to become available
            # in microseconds. A value of 0 means that the DB_TXN_NOWAIT
            # flag will be used.
            'tx_timeout'          : 0,

            # shared memory key for unix based systems
            'shm_key'             : 35,

            # replication manager configuration
            #'rep_config' : {
            #        'address'        : 'localhost:21568',
            #        'priority'       : 100,
            #        'worker_threads' : 1,
            #        'ack_policy'     : 'DB_REPMGR_ACKS_ONE_PEER',
            #        'site_address'   : 'localhost:6001',
            #        'nsites'         : 4
            #    }
		},
	'sessionmanager' : {
            'interface' : 'porcupine.core.session.incookie.SessionManager',
            'timeout'   : 1200,
            'guest'     : 'guest',
            'params'    : {'secret': 'SECRET'}
		},
	'templatelanguages' : {
            'string_template' : 'porcupine.core.templates.string_template'
		},
	'requestinterfaces' : {
            'CGI'        : 'porcupine.core.interfaces.cgi.cgi_handler',
            'MOD_PYTHON' : 'porcupine.core.interfaces.mod_python.mod_python_handler',
            'WSGI'       : 'porcupine.core.interfaces.wsgi.wsgi_handler',
		},
	'log' : {
            # 10 - DEBUG
            # 20 - INFO
            # 30 - WARNING
            # 40 - ERROR
            # 50 - CRITICAL
            'level'    : 20,
            'maxbytes' : 0,
            'backups'  : 3,
            'format'   : '%(asctime)s [%(levelname)s] %(message)s',
            'mp_format': '%(asctime)s [%(levelname)s/%(processName)s] %(message)s',
		},
	'mime_types' : (
            ('.quix', 'text/xml'),
            ('.wmv', 'video/x-ms-wmv'),
            ('.asf', 'video/x-ms-asf'),
            ('.flv', 'video/flv'),
            ('.flv', 'video/x-flv'),
            ('.3gp', 'video/3gpp'),
            ('.mp4', 'video/mp4'),
            ('.ogg', 'application/ogg'),
		),
}
